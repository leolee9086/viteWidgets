{"version":3,"file":"video.js","sources":["../../src/plugins/video/constants.js","../../src/plugins/video/PauseOverlay.js","../../src/plugins/video/PlayPauseButton.js","../../src/plugins/video/utils.js","../../src/plugins/video/ProgressBar.js","../../src/plugins/video/TimeCaption.js","../../src/plugins/video/VolumeButton.js","../../src/plugins/video/index.js"],"sourcesContent":["export const EVENTS = {\n  /**\n   * @event play\n   * @memberof PSV.plugins.VideoPlugin\n   * @summary Triggered when the video starts playing\n   */\n  PLAY         : 'play',\n  /**\n   * @event pause\n   * @memberof PSV.plugins.VideoPlugin\n   * @summary Triggered when the video is paused\n   */\n  PAUSE        : 'pause',\n  /**\n   * @event volume-change\n   * @memberof PSV.plugins.VideoPlugin\n   * @summary Triggered when the video volume changes\n   * @param {number} volume\n   */\n  VOLUME_CHANGE: 'volume-change',\n  /**\n   * @event progress\n   * @memberof PSV.plugins.VideoPlugin\n   * @summary Triggered when the video play progression changes\n   * @param {{time: number, duration: number, progress: number}} data\n   */\n  PROGRESS     : 'progress',\n  /**\n   * @event buffer\n   * @memberof PSV.plugins.VideoPlugin\n   * @summary Triggered when the video buffer changes\n   * @param {number} maxBuffer\n   */\n  BUFFER       : 'buffer',\n};\n","import { AbstractComponent, CONSTANTS, utils } from '../..';\nimport { EVENTS } from './constants';\nimport playIcon from './play.svg';\n\n/**\n * @private\n */\nexport class PauseOverlay extends AbstractComponent {\n\n  constructor(plugin) {\n    super(plugin.psv, 'psv-video-overlay');\n\n    /**\n     * @type {PSV.plugins.VideoPlugin}\n     * @private\n     * @readonly\n     */\n    this.plugin = plugin;\n\n    /**\n     * @type {HTMLElement}\n     * @private\n     * @readonly\n     */\n    this.button = document.createElement('button');\n    this.button.className = 'psv-video-bigbutton psv--capture-event';\n    this.button.innerHTML = playIcon;\n    this.container.appendChild(this.button);\n\n    this.psv.on(CONSTANTS.EVENTS.PANORAMA_LOADED, this);\n    this.plugin.on(EVENTS.PLAY, this);\n    this.plugin.on(EVENTS.PAUSE, this);\n    this.button.addEventListener('click', this);\n  }\n\n  /**\n   * @private\n   */\n  destroy() {\n    this.psv.off(CONSTANTS.EVENTS.PANORAMA_LOADED, this);\n    this.plugin.off(EVENTS.PLAY, this);\n    this.plugin.off(EVENTS.PAUSE, this);\n\n    delete this.plugin;\n\n    super.destroy();\n  }\n\n  /**\n   * @summary Handles events\n   * @param {Event} e\n   * @private\n   */\n  handleEvent(e) {\n    /* eslint-disable */\n    switch (e.type) {\n      case CONSTANTS.EVENTS.PANORAMA_LOADED:\n      case EVENTS.PLAY:\n      case EVENTS.PAUSE:\n        utils.toggleClass(this.button, 'psv-video-bigbutton--pause', !this.plugin.isPlaying());\n        break;\n      case 'click':\n        this.plugin.playPause();\n        break;\n    }\n    /* eslint-enable */\n  }\n\n}\n","import { AbstractButton } from '../..';\nimport { EVENTS } from './constants';\nimport pauseIcon from './pause.svg';\nimport playIcon from './play.svg';\n\n/**\n * @summary Navigation bar video play/pause button\n * @extends PSV.buttons.AbstractButton\n * @memberof PSV.buttons\n */\nexport class PlayPauseButton extends AbstractButton {\n\n  static id = 'videoPlay';\n  static groupId = 'video';\n  static icon = playIcon;\n  static iconActive = pauseIcon;\n\n  /**\n   * @param {PSV.components.Navbar} navbar\n   */\n  constructor(navbar) {\n    super(navbar, 'psv-button--hover-scale psv-video-play-button', true);\n\n    /**\n     * @type {PSV.plugins.VideoPlugin}\n     * @private\n     * @readonly\n     */\n    this.plugin = this.psv.getPlugin('video');\n\n    if (this.plugin) {\n      this.plugin.on(EVENTS.PLAY, this);\n      this.plugin.on(EVENTS.PAUSE, this);\n    }\n  }\n\n  /**\n   * @override\n   */\n  destroy() {\n    if (this.plugin) {\n      this.plugin.off(EVENTS.PLAY, this);\n      this.plugin.off(EVENTS.PAUSE, this);\n    }\n\n    delete this.plugin;\n\n    super.destroy();\n  }\n\n  /**\n   * @override\n   */\n  isSupported() {\n    return !!this.plugin;\n  }\n\n  /**\n   * @summary Handles events\n   * @param {Event} e\n   * @private\n   */\n  handleEvent(e) {\n    /* eslint-disable */\n    switch (e.type) {\n      case EVENTS.PLAY:\n      case EVENTS.PAUSE:\n        this.toggleActive(this.plugin.isPlaying());\n        break;\n    }\n    /* eslint-enable */\n  }\n\n  /**\n   * @override\n   * @description Toggles video playback\n   */\n  onClick() {\n    this.plugin.playPause();\n  }\n\n}\n","/**\n * @private\n */\nexport function formatTime(time) {\n  const seconds = Math.round(time % 60);\n  const minutes = Math.round(time - seconds) / 60;\n  return `${minutes}:${('0' + seconds).slice(-2)}`;\n}\n","import { AbstractComponent, CONSTANTS, utils } from '../..';\nimport { EVENTS } from './constants';\nimport { formatTime } from './utils';\n\n/**\n * @private\n */\nexport class ProgressBar extends AbstractComponent {\n\n  constructor(plugin) {\n    super(plugin.psv, 'psv-video-progressbar');\n\n    /**\n     * @type {PSV.plugins.VideoPlugin}\n     * @private\n     * @readonly\n     */\n    this.plugin = plugin;\n\n    /**\n     * @type {HTMLElement}\n     * @private\n     * @readonly\n     */\n    this.bufferElt = document.createElement('div');\n    this.bufferElt.className = 'psv-video-progressbar__buffer';\n    this.container.appendChild(this.bufferElt);\n\n    /**\n     * @type {HTMLElement}\n     * @private\n     * @readonly\n     */\n    this.progressElt = document.createElement('div');\n    this.progressElt.className = 'psv-video-progressbar__progress';\n    this.container.appendChild(this.progressElt);\n\n    /**\n     * @type {HTMLElement}\n     * @private\n     * @readonly\n     */\n    this.handleElt = document.createElement('div');\n    this.handleElt.className = 'psv-video-progressbar__handle';\n    this.container.appendChild(this.handleElt);\n\n    /**\n     * @type {PSV.utils.Slider}\n     * @private\n     * @readonly\n     */\n    this.slider = new utils.Slider({\n      psv      : this.psv,\n      container: this.container,\n      direction: utils.Slider.HORIZONTAL,\n      onUpdate : e => this.__onSliderUpdate(e),\n    });\n\n    this.psv.on(CONSTANTS.EVENTS.PANORAMA_LOADED, this);\n    this.plugin.on(EVENTS.BUFFER, this);\n    this.plugin.on(EVENTS.PROGRESS, this);\n\n    this.prop.req = window.requestAnimationFrame(() => this.__updateProgress());\n\n    this.hide();\n  }\n\n  /**\n   * @override\n   */\n  destroy() {\n    this.psv.off(CONSTANTS.EVENTS.PANORAMA_LOADED, this);\n    this.plugin.off(EVENTS.BUFFER, this);\n    this.plugin.off(EVENTS.PROGRESS, this);\n\n    this.slider.destroy();\n    this.prop.tooltip?.hide();\n    window.cancelAnimationFrame(this.prop.req);\n\n    delete this.prop.tooltip;\n    delete this.slider;\n    delete this.plugin;\n\n    super.destroy();\n  }\n\n  /**\n   * @private\n   */\n  handleEvent(e) {\n    /* eslint-disable */\n    switch (e.type) {\n      case CONSTANTS.EVENTS.PANORAMA_LOADED:\n      case EVENTS.BUFFER:\n      case EVENTS.PROGRESS:\n        this.bufferElt.style.width = `${this.plugin.getBufferProgress() * 100}%`;\n        break;\n    }\n    /* eslint-enable */\n  }\n\n  /**\n   * @private\n   */\n  __updateProgress() {\n    this.progressElt.style.width = `${this.plugin.getProgress() * 100}%`;\n\n    this.prop.req = window.requestAnimationFrame(() => this.__updateProgress());\n  }\n\n  /**\n   * @private\n   */\n  __onSliderUpdate(e) {\n    if (e.mouseover) {\n      this.handleElt.style.display = 'block';\n      this.handleElt.style.left = `${e.value * 100}%`;\n\n      const time = formatTime(this.plugin.getDuration() * e.value);\n\n      if (!this.prop.tooltip) {\n        this.prop.tooltip = this.psv.tooltip.create({\n          top    : e.cursor.clientY,\n          left   : e.cursor.clientX,\n          content: time,\n        });\n      }\n      else {\n        this.prop.tooltip.content.innerHTML = time;\n        this.prop.tooltip.move({\n          top : e.cursor.clientY,\n          left: e.cursor.clientX,\n        });\n      }\n    }\n    else {\n      this.handleElt.style.display = 'none';\n\n      this.prop.tooltip?.hide();\n      delete this.prop.tooltip;\n    }\n    if (e.click) {\n      this.plugin.setProgress(e.value);\n    }\n  }\n\n}\n","import { AbstractComponent, CONSTANTS } from '../..';\nimport { EVENTS } from './constants';\nimport { formatTime } from './utils';\n\n/**\n * @summary Navigation bar video time display\n * @extends PSV.buttons.AbstractButton\n * @memberof PSV.buttons\n */\nexport class TimeCaption extends AbstractComponent {\n\n  static id = 'videoTime';\n  static groupId = 'video';\n\n  /**\n   * @param {PSV.components.Navbar} navbar\n   */\n  constructor(navbar) {\n    super(navbar, 'psv-caption psv-video-time');\n\n    /**\n     * @member {HTMLElement}\n     * @readonly\n     * @private\n     */\n    this.content = document.createElement('div');\n    this.content.className = 'psv-caption-content';\n    this.container.appendChild(this.content);\n\n    /**\n     * @type {PSV.plugins.VideoPlugin}\n     * @private\n     * @readonly\n     */\n    this.plugin = this.psv.getPlugin('video');\n\n    if (this.plugin) {\n      this.psv.on(CONSTANTS.EVENTS.PANORAMA_LOADED, this);\n      this.plugin.on(EVENTS.PROGRESS, this);\n    }\n  }\n\n  /**\n   * @override\n   */\n  destroy() {\n    if (this.plugin) {\n      this.psv.off(CONSTANTS.EVENTS.PANORAMA_LOADED, this);\n      this.plugin.off(EVENTS.PROGRESS, this);\n    }\n\n    delete this.plugin;\n\n    super.destroy();\n  }\n\n  /**\n   * @summary Handles events\n   * @param {Event} e\n   * @private\n   */\n  handleEvent(e) {\n    /* eslint-disable */\n    switch (e.type) {\n      case CONSTANTS.EVENTS.PANORAMA_LOADED:\n      case EVENTS.PROGRESS:\n        this.content.innerHTML = `<strong>${formatTime(this.plugin.getTime())}</strong> / ${formatTime(this.plugin.getDuration())}`;\n        break;\n    }\n    /* eslint-enable */\n  }\n\n}\n","import { AbstractButton, CONSTANTS, utils } from '../..';\nimport { EVENTS } from './constants';\nimport volumeIcon from './volume.svg';\n\n/**\n * @summary Navigation bar video volume button\n * @extends PSV.buttons.AbstractButton\n * @memberof PSV.buttons\n */\nexport class VolumeButton extends AbstractButton {\n\n  static id = 'videoVolume';\n  static groupId = 'video';\n  static icon = volumeIcon;\n\n  /**\n   * @param {PSV.components.Navbar} navbar\n   */\n  constructor(navbar) {\n    super(navbar, 'psv-button--hover-scale psv-video-volume-button', true);\n\n    /**\n     * @type {PSV.plugins.VideoPlugin}\n     * @private\n     * @readonly\n     */\n    this.plugin = this.psv.getPlugin('video');\n\n    /**\n     * @type {HTMLElement}\n     * @private\n     * @readonly\n     */\n    this.rangeContainer = document.createElement('div');\n    this.rangeContainer.className = 'psv-video-volume__container';\n    this.container.appendChild(this.rangeContainer);\n\n    /**\n     * @type {HTMLElement}\n     * @private\n     * @readonly\n     */\n    this.range = document.createElement('div');\n    this.range.className = 'psv-video-volume__range';\n    this.rangeContainer.appendChild(this.range);\n\n    /**\n     * @type {HTMLElement}\n     * @private\n     * @readonly\n     */\n    this.trackElt = document.createElement('div');\n    this.trackElt.className = 'psv-video-volume__track';\n    this.range.appendChild(this.trackElt);\n\n    /**\n     * @type {HTMLElement}\n     * @private\n     * @readonly\n     */\n    this.progressElt = document.createElement('div');\n    this.progressElt.className = 'psv-video-volume__progress';\n    this.range.appendChild(this.progressElt);\n\n    /**\n     * @type {HTMLElement}\n     * @private\n     * @readonly\n     */\n    this.handleElt = document.createElement('div');\n    this.handleElt.className = 'psv-video-volume__handle';\n    this.range.appendChild(this.handleElt);\n\n    /**\n     * @type {PSV.utils.Slider}\n     * @private\n     * @readonly\n     */\n    this.slider = new utils.Slider({\n      psv      : this.psv,\n      container: this.range,\n      direction: utils.Slider.VERTICAL,\n      onUpdate : e => this.__onSliderUpdate(e),\n    });\n\n    if (this.plugin) {\n      this.psv.on(CONSTANTS.EVENTS.PANORAMA_LOADED, this);\n      this.plugin.on(EVENTS.PLAY, this);\n      this.plugin.on(EVENTS.VOLUME_CHANGE, this);\n\n      this.__setVolume(0);\n    }\n  }\n\n  /**\n   * @override\n   */\n  destroy() {\n    if (this.plugin) {\n      this.psv.off(CONSTANTS.EVENTS.PANORAMA_LOADED, this);\n      this.plugin.off(EVENTS.PLAY, this);\n      this.plugin.off(EVENTS.VOLUME_CHANGE, this);\n    }\n\n    this.slider.destroy();\n\n    delete this.plugin;\n\n    super.destroy();\n  }\n\n  /**\n   * @override\n   */\n  isSupported() {\n    return !!this.plugin;\n  }\n\n  /**\n   * @summary Handles events\n   * @param {Event} e\n   * @private\n   */\n  handleEvent(e) {\n    /* eslint-disable */\n    switch (e.type) {\n      case CONSTANTS.EVENTS.PANORAMA_LOADED:\n      case EVENTS.PLAY:\n      case EVENTS.VOLUME_CHANGE:\n        this.__setVolume(this.plugin.getVolume());\n        break;\n    }\n    /* eslint-enable */\n  }\n\n  /**\n   * @override\n   * @description Toggles video muted\n   */\n  onClick() {\n    this.plugin.setMute();\n  }\n\n  /**\n   * @private\n   */\n  __onSliderUpdate(e) {\n    if (e.mousedown) {\n      this.plugin.setVolume(e.value);\n    }\n  }\n\n  /**\n   * @private\n   */\n  __setVolume(volume) {\n    let level;\n    if (volume === 0) level = 0;\n    else if (volume < 0.333) level = 1;\n    else if (volume < 0.666) level = 2;\n    else level = 3;\n\n    utils.toggleClass(this.container, 'psv-video-volume-button--0', level === 0);\n    utils.toggleClass(this.container, 'psv-video-volume-button--1', level === 1);\n    utils.toggleClass(this.container, 'psv-video-volume-button--2', level === 2);\n    utils.toggleClass(this.container, 'psv-video-volume-button--3', level === 3);\n\n    this.handleElt.style.bottom = `${volume * 100}%`;\n    this.progressElt.style.height = `${volume * 100}%`;\n  }\n\n}\n","import { SplineCurve, Vector2 } from 'three';\nimport { AbstractPlugin, CONSTANTS, DEFAULTS, PSVError, registerButton, utils } from '../..';\nimport { EVENTS } from './constants';\nimport { PauseOverlay } from './PauseOverlay';\nimport { PlayPauseButton } from './PlayPauseButton';\nimport { ProgressBar } from './ProgressBar';\nimport { TimeCaption } from './TimeCaption';\nimport { VolumeButton } from './VolumeButton';\nimport './style.scss';\n\n\n/**\n * @typedef {Object} PSV.plugins.VideoPlugin.Keypoint\n * @property {PSV.ExtendedPosition} position\n * @property {number} time\n */\n\n/**\n * @typedef {Object} PSV.plugins.VideoPlugin.Options\n * @property {boolean} [progressbar=true] - displays a progressbar on top of the navbar\n * @property {boolean} [bigbutton=true] - displays a big \"play\" button in the center of the viewer\n * @property {PSV.plugins.VideoPlugin.Keypoint[]} [keypoints] - defines autorotate timed keypoints\n */\n\n\n// add video buttons\nDEFAULTS.lang[PlayPauseButton.id] = 'Play/Pause';\nDEFAULTS.lang[VolumeButton.id] = 'Volume';\nregisterButton(PlayPauseButton);\nregisterButton(VolumeButton);\nregisterButton(TimeCaption);\nDEFAULTS.navbar.unshift(PlayPauseButton.groupId);\n\n\nexport { EVENTS } from './constants';\n\n\n/**\n * @summary Controls a video adapter\n * @extends PSV.plugins.AbstractPlugin\n * @memberof PSV.plugins\n */\nexport class VideoPlugin extends AbstractPlugin {\n\n  static id = 'video';\n\n  static EVENTS = EVENTS;\n\n  /**\n   * @param {PSV.Viewer} psv\n   * @param {PSV.plugins.VideoPlugin.Options} options\n   */\n  constructor(psv, options) {\n    super(psv);\n\n    if (!this.psv.adapter.constructor.id.includes('video')) {\n      throw new PSVError('VideoPlugin can only be used with a video adapter.');\n    }\n\n    /**\n     * @member {Object}\n     * @property {THREE.SplineCurve} curve\n     * @property {PSV.plugins.VideoPlugin.Keypoint} start\n     * @property {PSV.plugins.VideoPlugin.Keypoint} end\n     * @property {PSV.plugins.VideoPlugin.Keypoint[]} keypoints\n     * @private\n     */\n    this.autorotate = {\n      curve    : null,\n      start    : null,\n      end      : null,\n      keypoints: null,\n    };\n\n    /**\n     * @member {PSV.plugins.VideoPlugin.Options}\n     * @private\n     */\n    this.config = {\n      progressbar: true,\n      bigbutton  : true,\n      ...options,\n    };\n\n    if (this.config.progressbar) {\n      this.progressbar = new ProgressBar(this);\n    }\n\n    if (this.config.bigbutton) {\n      this.overlay = new PauseOverlay(this);\n    }\n\n    /**\n     * @type {PSV.plugins.MarkersPlugin}\n     * @private\n     */\n    this.markers = null;\n  }\n\n  /**\n   * @package\n   */\n  init() {\n    super.init();\n\n    this.markers = this.psv.getPlugin('markers');\n\n    if (this.config.keypoints) {\n      this.setKeypoints(this.config.keypoints);\n      delete this.config.keypoints;\n    }\n\n    this.psv.on(CONSTANTS.EVENTS.AUTOROTATE, this);\n    this.psv.on(CONSTANTS.EVENTS.BEFORE_RENDER, this);\n    this.psv.on(CONSTANTS.EVENTS.PANORAMA_LOADED, this);\n    this.psv.on(CONSTANTS.EVENTS.KEY_PRESS, this);\n  }\n\n  /**\n   * @package\n   */\n  destroy() {\n    this.psv.off(CONSTANTS.EVENTS.AUTOROTATE, this);\n    this.psv.off(CONSTANTS.EVENTS.BEFORE_RENDER, this);\n    this.psv.off(CONSTANTS.EVENTS.PANORAMA_LOADED, this);\n    this.psv.off(CONSTANTS.EVENTS.KEY_PRESS, this);\n\n    delete this.autorotate;\n    delete this.progressbar;\n    delete this.overlay;\n\n    super.destroy();\n  }\n\n  /**\n   * @private\n   */\n  handleEvent(e) {\n    /* eslint-disable */\n    // @formatter:off\n    switch (e.type) {\n      case CONSTANTS.EVENTS.BEFORE_RENDER:\n        this.__autorotate();\n        break;\n      case CONSTANTS.EVENTS.AUTOROTATE:\n        this.__configureAutorotate();\n        break;\n      case CONSTANTS.EVENTS.PANORAMA_LOADED:\n        this.__bindVideo(e.args[0]);\n        this.progressbar?.show();\n        break;\n      case CONSTANTS.EVENTS.KEY_PRESS:\n        this.__onKeyPress(e, e.args[0]);\n        break;\n      case 'play':         this.trigger(EVENTS.PLAY); break;\n      case 'pause':        this.trigger(EVENTS.PAUSE); break;\n      case 'progress':     this.trigger(EVENTS.BUFFER, this.getBufferProgress()); break;\n      case 'volumechange': this.trigger(EVENTS.VOLUME_CHANGE, this.getVolume()); break;\n      case 'timeupdate':\n        this.trigger(EVENTS.PROGRESS, {\n          time    : this.getTime(),\n          duration: this.getDuration(),\n          progress: this.getProgress(),\n        });\n        break;\n    }\n    // @formatter:on\n    /* eslint-enable */\n  }\n\n  /**\n   * @private\n   */\n  __bindVideo(textureData) {\n    this.video = textureData.texture.image;\n\n    this.video.addEventListener('play', this);\n    this.video.addEventListener('pause', this);\n    this.video.addEventListener('progress', this);\n    this.video.addEventListener('volumechange', this);\n    this.video.addEventListener('timeupdate', this);\n  }\n\n  /**\n   * @private\n   */\n  __onKeyPress(e, key) {\n    if (key === CONSTANTS.KEY_CODES.Space) {\n      this.playPause();\n      e.preventDefault();\n    }\n  }\n\n  /**\n   * @summary Returns the durection of the video\n   * @returns {number}\n   */\n  getDuration() {\n    return this.video?.duration ?? 0;\n  }\n\n  /**\n   * @summary Returns the current time of the video\n   * @returns {number}\n   */\n  getTime() {\n    return this.video?.currentTime ?? 0;\n  }\n\n  /**\n   * @summary Returns the play progression of the video\n   * @returns {number} 0-1\n   */\n  getProgress() {\n    return this.video ? this.video.currentTime / this.video.duration : 0;\n  }\n\n  /**\n   * @summary Returns if the video is playing\n   * @returns {boolean}\n   */\n  isPlaying() {\n    return this.video ? !this.video.paused : false;\n  }\n\n  /**\n   * @summary Returns the video volume\n   * @returns {number}\n   */\n  getVolume() {\n    return this.video?.muted ? 0 : this.video?.volume ?? 0;\n  }\n\n  /**\n   * @summary Starts or pause the video\n   */\n  playPause() {\n    if (this.video) {\n      if (this.video.paused) {\n        this.video.play();\n      }\n      else {\n        this.video.pause();\n      }\n    }\n  }\n\n  /**\n   * @summary Starts the video if paused\n   */\n  play() {\n    if (this.video && this.video.paused) {\n      this.video.play();\n    }\n  }\n\n  /**\n   * @summary Pauses the cideo if playing\n   */\n  pause() {\n    if (this.video && !this.video.paused) {\n      this.video.pause();\n    }\n  }\n\n  /**\n   * @summary Sets the volume of the video\n   * @param {number} volume\n   */\n  setVolume(volume) {\n    if (this.video) {\n      this.video.muted = false;\n      this.video.volume = volume;\n    }\n  }\n\n  /**\n   * @summary (Un)mutes the video\n   * @param {boolean} [mute] - toggle if undefined\n   */\n  setMute(mute) {\n    if (this.video) {\n      this.video.muted = mute === undefined ? !this.video.muted : mute;\n      if (!this.video.muted && this.video.volume === 0) {\n        this.video.volume = 0.1;\n      }\n    }\n  }\n\n  /**\n   * @summary Changes the current time of the video\n   * @param {number} time\n   */\n  setTime(time) {\n    if (this.video) {\n      this.video.currentTime = time;\n    }\n  }\n\n  /**\n   * @summary Changes the progression of the video\n   * @param {number} progress 0-1\n   */\n  setProgress(progress) {\n    if (this.video) {\n      this.video.currentTime = this.video.duration * progress;\n    }\n  }\n\n  getBufferProgress() {\n    if (this.video) {\n      let maxBuffer = 0;\n\n      const buffer = this.video.buffered;\n\n      for (let i = 0, l = buffer.length; i < l; i++) {\n        if (buffer.start(i) <= this.video.currentTime && buffer.end(i) >= this.video.currentTime) {\n          maxBuffer = buffer.end(i);\n          break;\n        }\n      }\n\n      return Math.max(this.video.currentTime, maxBuffer) / this.video.duration;\n    }\n    else {\n      return 0;\n    }\n  }\n\n  /**\n   * @summary Changes the keypoints\n   * @param {PSV.plugins.VideoPlugin.Keypoint[]} keypoints\n   */\n  setKeypoints(keypoints) {\n    if (keypoints && keypoints.length < 2) {\n      throw new PSVError('At least two points are required');\n    }\n\n    this.autorotate.keypoints = utils.clone(keypoints);\n\n    if (this.autorotate.keypoints) {\n      this.autorotate.keypoints.forEach((pt, i) => {\n        if (pt.position) {\n          const position = this.psv.dataHelper.cleanPosition(pt.position);\n          pt.position = [position.longitude, position.latitude];\n        }\n        else {\n          throw new PSVError(`Keypoint #${i} is missing marker or position`);\n        }\n\n        if (utils.isNil(pt.time)) {\n          throw new PSVError(`Keypoint #${i} is missing time`);\n        }\n      });\n\n      this.autorotate.keypoints.sort((a, b) => a.time - b.time);\n    }\n\n    this.__configureAutorotate();\n  }\n\n  /**\n   * @private\n   */\n  __configureAutorotate() {\n    delete this.autorotate.curve;\n    delete this.autorotate.start;\n    delete this.autorotate.end;\n\n    if (this.psv.isAutorotateEnabled() && this.autorotate.keypoints) {\n      // cancel core rotation\n      this.psv.dynamics.position.stop();\n    }\n  }\n\n  /**\n   * @private\n   */\n  __autorotate() {\n    if (!this.psv.isAutorotateEnabled() || !this.autorotate.keypoints) {\n      return;\n    }\n\n    const currentTime = this.getTime();\n    const autorotate = this.autorotate;\n\n    if (!autorotate.curve || currentTime < autorotate.start.time || currentTime >= autorotate.end.time) {\n      this.__autorotateNext(currentTime);\n    }\n\n    if (autorotate.start === autorotate.end) {\n      this.psv.rotate({\n        longitude: autorotate.start.position[0],\n        latitude : autorotate.start.position[1],\n      });\n    }\n    else {\n      const progress = (currentTime - autorotate.start.time) / (autorotate.end.time - autorotate.start.time);\n      // only the middle segment contains the current section\n      const pt = autorotate.curve.getPoint(1 / 3 + progress / 3);\n\n      this.psv.dynamics.position.goto({\n        longitude: pt.x,\n        latitude : pt.y,\n      });\n    }\n  }\n\n  /**\n   * @private\n   */\n  __autorotateNext(currentTime) {\n    let k1 = null;\n    let k2 = null;\n\n    const keypoints = this.autorotate.keypoints;\n    const l = keypoints.length - 1;\n\n    if (currentTime < keypoints[0].time) {\n      k1 = 0;\n      k2 = 0;\n    }\n    for (let i = 0; i < l; i++) {\n      if (currentTime >= keypoints[i].time && currentTime < keypoints[i + 1].time) {\n        k1 = i;\n        k2 = i + 1;\n        break;\n      }\n    }\n    if (currentTime >= keypoints[l].time) {\n      k1 = l;\n      k2 = l;\n    }\n\n    // get the 4 points necessary to compute the current movement\n    // one point before and two points after the current\n    const workPoints = [\n      keypoints[Math.max(0, k1 - 1)].position,\n      keypoints[k1].position,\n      keypoints[k2].position,\n      keypoints[Math.min(l, k2 + 1)].position,\n    ];\n\n    // apply offsets to avoid crossing the origin\n    const workVectors = [new Vector2(workPoints[0][0], workPoints[0][1])];\n\n    let k = 0;\n    for (let i = 1; i <= 3; i++) {\n      const d = workPoints[i - 1][0] - workPoints[i][0];\n      if (d > Math.PI) { // crossed the origin left to right\n        k += 1;\n      }\n      else if (d < -Math.PI) { // crossed the origin right to left\n        k -= 1;\n      }\n      if (k !== 0 && i === 1) {\n        // do not modify first point, apply the reverse offset the the previous point instead\n        workVectors[0].x -= k * 2 * Math.PI;\n        k = 0;\n      }\n      workVectors.push(new Vector2(workPoints[i][0] + k * 2 * Math.PI, workPoints[i][1]));\n    }\n\n    this.autorotate.curve = new SplineCurve(workVectors);\n    this.autorotate.start = keypoints[k1];\n    this.autorotate.end = keypoints[k2];\n\n    // debugCurve(this.markers, this.autorotate.curve.getPoints(16 * 3).map(p => ([p.x, p.y])), 16);\n  }\n\n}\n"],"names":["EVENTS","PLAY","PAUSE","VOLUME_CHANGE","PROGRESS","BUFFER","PauseOverlay","plugin","psv","button","document","createElement","className","innerHTML","playIcon","container","appendChild","on","CONSTANTS","PANORAMA_LOADED","addEventListener","destroy","off","handleEvent","e","type","utils","toggleClass","isPlaying","playPause","AbstractComponent","PlayPauseButton","navbar","getPlugin","isSupported","toggleActive","onClick","AbstractButton","id","groupId","icon","iconActive","pauseIcon","formatTime","time","seconds","Math","round","minutes","slice","ProgressBar","bufferElt","progressElt","handleElt","slider","Slider","direction","HORIZONTAL","onUpdate","__onSliderUpdate","prop","req","window","requestAnimationFrame","__updateProgress","hide","tooltip","cancelAnimationFrame","style","width","getBufferProgress","getProgress","mouseover","display","left","value","getDuration","create","top","cursor","clientY","clientX","content","move","click","setProgress","TimeCaption","getTime","VolumeButton","rangeContainer","range","trackElt","VERTICAL","__setVolume","getVolume","setMute","mousedown","setVolume","volume","level","bottom","height","volumeIcon","DEFAULTS","lang","registerButton","unshift","VideoPlugin","options","adapter","constructor","includes","PSVError","autorotate","curve","start","end","keypoints","config","progressbar","bigbutton","overlay","markers","init","setKeypoints","AUTOROTATE","BEFORE_RENDER","KEY_PRESS","__autorotate","__configureAutorotate","__bindVideo","args","show","__onKeyPress","trigger","duration","progress","textureData","video","texture","image","key","KEY_CODES","Space","preventDefault","currentTime","paused","muted","play","pause","mute","undefined","setTime","maxBuffer","buffer","buffered","i","l","length","max","clone","forEach","pt","position","dataHelper","cleanPosition","longitude","latitude","isNil","sort","a","b","isAutorotateEnabled","dynamics","stop","__autorotateNext","rotate","getPoint","goto","x","y","k1","k2","workPoints","min","workVectors","Vector2","k","d","PI","push","SplineCurve","AbstractPlugin"],"mappings":"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"}