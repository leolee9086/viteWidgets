{"version":3,"file":"moveable.cjs.js","sources":["../src/InnerMoveable.tsx","../src/consts.ts","../src/MoveableManager.tsx","../src/Moveable.tsx","../src/utils.ts","../src/index.cjs.ts"],"sourcesContent":["import * as React from \"react\";\nimport { createPortal } from \"react-dom\";\nimport Moveable from \"react-moveable\";\nimport { ref } from \"framework-utils\";\n\nexport default class InnerMoveable extends React.Component<any> {\n    public state: any = {};\n    public moveable!: Moveable;\n    constructor(props: any) {\n        super(props);\n        this.state = this.props;\n    }\n    public render(): React.ReactNode {\n        return createPortal(<Moveable ref={ref(this, \"moveable\")} {...this.state} />, this.state.parentElement);\n    }\n}\n","import {\n    MOVEABLE_PROPS_MAP,\n    MOVEABLE_PROPS,\n    MOVEABLE_METHODS,\n    MOVEABLE_EVENTS,\n} from \"react-moveable\";\n\nexport const PROPERTIES: string[] = MOVEABLE_PROPS;\nexport const METHODS: string[] = MOVEABLE_METHODS;\nexport const EVENTS: string[] = MOVEABLE_EVENTS;\nexport const PROPS_MAP: Record<string, any> = MOVEABLE_PROPS_MAP;\n","import { ref, Properties } from \"framework-utils\";\nimport * as React from \"react\";\nimport { render } from \"react-dom\";\nimport InnerMoveable from \"./InnerMoveable\";\nimport {\n    MoveableInterface,\n    MoveableOptions, MoveableProperties,\n} from \"react-moveable/types\";\nimport { camelize, isArray } from \"@daybrush/utils\";\nimport { MoveableEventsParameters } from \"./types\";\nimport { PROPERTIES, EVENTS, METHODS } from \"./consts\";\nimport EventEmitter from \"@scena/event-emitter\";\n/**\n * Moveable is Draggable! Resizable! Scalable! Rotatable!\n * @sort 1\n * @alias Moveable\n * @extends EventEmitter\n */\n@Properties(METHODS, (prototype, property) => {\n    if (prototype[property]) {\n        return;\n    }\n    prototype[property] = function(...args: any[]) {\n        const self = this.getMoveable();\n\n        if (!self || !self[property]) {\n            return;\n        }\n        return self[property](...args);\n    };\n})\n@Properties(PROPERTIES, (prototype, property) => {\n    Object.defineProperty(prototype, property, {\n        get() {\n            return this.getMoveable().props[property];\n        },\n        set(value) {\n            this.setState({\n                [property]: value,\n            });\n        },\n        enumerable: true,\n        configurable: true,\n    });\n})\nclass MoveableManager extends EventEmitter<MoveableEventsParameters> {\n    private innerMoveable!: InnerMoveable | null;\n    private tempElement: HTMLElement | null = document.createElement(\"div\");\n\n    /**\n     *\n     */\n    constructor(parentElement: HTMLElement | SVGElement, options: MoveableOptions = {}) {\n        super();\n        const nextOptions = { ...options };\n\n        const events: any = {};\n\n        EVENTS.forEach(name => {\n            events[camelize(`on ${name}`)] = (e: any) => this.trigger<any>(name, e);\n        });\n\n        render(\n            <InnerMoveable\n                ref={ref(this, \"innerMoveable\")}\n                parentElement={parentElement}\n                {...nextOptions}\n                {...events}\n            />,\n            this.tempElement,\n        );\n        const target = nextOptions.target!;\n        if (isArray(target) && target.length > 1) {\n            this.updateRect();\n        }\n    }\n    public setState(state: Partial<MoveableOptions>, callback?: () => any) {\n        this.innerMoveable!.setState(state, callback);\n    }\n    public forceUpdate(callback?: () => any) {\n        this.innerMoveable!.forceUpdate(callback);\n    }\n    public dragStart(e: MouseEvent | TouchEvent) {\n        const innerMoveable = this.innerMoveable;\n        if ((innerMoveable as any).$_timer) {\n            this.forceUpdate();\n        }\n        this.getMoveable().dragStart(e);\n    }\n    public destroy() {\n        render(null as any, this.tempElement!);\n        this.off();\n        this.tempElement = null;\n        this.innerMoveable = null;\n    }\n    private getMoveable() {\n        return this.innerMoveable!.moveable;\n    }\n}\n\ninterface MoveableManager extends MoveableInterface, MoveableProperties {\n}\n\nexport default MoveableManager;\n","import MoveableManager from \"./MoveableManager\";\n\nexport default class Moveable extends MoveableManager {}\n","import { Able, DefaultProps } from \"react-moveable/types\";\nimport { getElementInfo as getElementInfoFunction, makeAble as makeAbleFunction } from \"react-moveable\";\n\nexport function getElementInfo(\n    target: SVGElement | HTMLElement,\n    container?: SVGElement | HTMLElement | null,\n    rootContainer?: SVGElement | HTMLElement | null | undefined,\n) {\n    return getElementInfoFunction(target, container, rootContainer);\n};\nexport function makeAble<\n    Name extends string,\n    AbleObject extends Partial<Able<any, any>>,\n    Props extends DefaultProps<Name, AbleObject>,\n>(name: Name, able: AbleObject) {\n    return makeAbleFunction<Name, AbleObject, Props>(name, able);\n}\n","import Moveable, * as modules from \"./index\";\n\nfor (const name in modules) {\n    (Moveable as any)[name] = (modules as any)[name];\n}\n\nmodule.exports = Moveable;\nexport * from \"./index\";\nexport default Moveable;\n"],"names":["InnerMoveable","_super","__extends","props","_this","call","state","render","createPortal","React","createElement","Moveable","__assign","ref","parentElement","Component","PROPERTIES","MOVEABLE_PROPS","METHODS","MOVEABLE_METHODS","EVENTS","MOVEABLE_EVENTS","PROPS_MAP","MOVEABLE_PROPS_MAP","MoveableManager","options","tempElement","document","nextOptions","events","forEach","name","camelize","concat","e","trigger","target","isArray","length","updateRect","setState","callback","innerMoveable","forceUpdate","dragStart","$_timer","getMoveable","destroy","off","moveable","__decorate","Properties","prototype","property","args","_i","arguments","self","Object","defineProperty","get","set","value","_a","enumerable","configurable","EventEmitter","getElementInfo","container","rootContainer","getElementInfoFunction","makeAble","able","makeAbleFunction","modules","module","exports"],"mappings":"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"}